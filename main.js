(()=>{'use strict';function e(e){const t=e;return{getName:()=>t,createGameBoard:(...e)=>{const t=function(){let e={A1:!1,A2:!1,A3:!1,A4:!1,A5:!1,A6:!1,A7:!1,A8:!1,B1:!1,B2:!1,B3:!1,B4:!1,B5:!1,B6:!1,B7:!1,B8:!1,C1:!1,C2:!1,C3:!1,C4:!1,C5:!1,C6:!1,C7:!1,C8:!1,D1:!1,D2:!1,D3:!1,D4:!1,D5:!1,D6:!1,D7:!1,D8:!1,E1:!1,E2:!1,E3:!1,E4:!1,E5:!1,E6:!1,E7:!1,E8:!1,F1:!1,F2:!1,F3:!1,F4:!1,F5:!1,F6:!1,F7:!1,F8:!1,G1:!1,G2:!1,G3:!1,G4:!1,G5:!1,G6:!1,G7:!1,G8:!1,H1:!1,H2:!1,H3:!1,H4:!1,H5:!1,H6:!1,H7:!1,H8:!1},t=[];const r=(...e)=>{const r=function(...e){let t=e;const r={1:'Spy',2:'Destroyer',3:'Cruiser',4:'Battleship',5:'Carrier'}[t.length];return{getShipName:()=>r,getShipCoord:()=>t,isSunkNextHit:()=>1===t.length,removeSquareHit:e=>{const r=(e=>t.indexOf(e))(e);t=t.filter((e=>t.indexOf(e)!==r))}}}(...e);return t=n(r),o(r),r},o=t=>{const r=t.getShipCoord();let o=0;for(const[t]of Object.entries(e))t===r[o]&&(e[t]=!0,o++)},n=e=>[...t,e],a=t=>Object.assign({...e},{[`${t}`]:'Hit'}),i=e=>{const r=s(e);return t.filter((e=>t.indexOf(e)!==r))},s=e=>t.findIndex((t=>t.getShipName()===e.getShipName()));return{getBoardGrid:()=>e,getBoardShips:()=>t,createShip:r,populateGameboard:e=>{let t=0;for(;t<e.length;)r(...e[t]),t++},receiveAttackFromPlayer:(r='A1')=>{const o=r;if(!(t=>{for(const[r]of Object.entries(e))if(r===t&&e[r])return!0;return!1})(o))return o;{const r=(e=>t.find((t=>t.getShipCoord().includes(e))))(o);r.isSunkNextHit()?t=i(r):e=((e,t)=>(t.removeSquareHit(e),a(e)))(o,r)}},removeShipFromShipsArray:i,isAllShipsSunk:()=>0===t.length}}();return t.populateGameboard(e),t},sendAttackCoordsToGame:(e='A1')=>e,sendRandomAttackCoordsToGame:e=>{const t=Object.keys(e.getBoardGrid()).length,r=(o=0,n=t,Math.floor(Math.random()*(o-n))+n);var o,n;return Object.keys(e.getBoardGrid())[r]}}}(function(){const t=(e,t)=>playerInTurn===t?e:t,r=(e,t,r)=>playerInTurn===e?t:r;return{setupGame:()=>{let o=a,n=c;const a=e('Victor'),i=e('Olga'),s=a.createGameBoard(['A1'],['B1','B2'],['C1','C2','C3'],['D1','D2','D3','D4'],['E1','E2','E3','E4','E5']),c=i.createGameBoard(['A1'],['B1','B2'],['C1','C2','C3'],['D1','D2','D3','D4'],['E1','E2','E3','E4','E5']);for(;!a.isPlayerDefeated()||!i.isPlayerDefeated();){const e=o.sendAttackCoordsToGame('A1');n.receiveAttackFromPlayer(e),n.isAllShipsSunk(),n.sendStateToDOM(),o=t(a,i),n=r(s,c)}}}})().setupGame()})()
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QmdFLEVBQVVoRSxFQUFPLFFBRWpCbUUsRUFBYUosRUFBUTNELGdCQUN2QixDQUFDLE1BQ0QsQ0FBQyxLQUFLLE1BQ04sQ0FBQyxLQUFLLEtBQUssTUFDWCxDQUFDLEtBQUssS0FBSyxLQUFLLE1BQ2hCLENBQUMsS0FBSyxLQUFLLEtBQUssS0FBSyxPQUduQmdFLEVBQWFKLEVBQVE1RCxnQkFDdkIsQ0FBQyxNQUNELENBQUMsS0FBSyxNQUNOLENBQUMsS0FBSyxLQUFLLE1BQ1gsQ0FBQyxLQUFLLEtBQUssS0FBSyxNQUNoQixDQUFDLEtBQUssS0FBSyxLQUFLLEtBQUssT0FHekIsTUFDSzJELEVBQVFRLHFCQUVSUCxFQUFRTyxvQkFDWixDQUNHLE1BQU1DLEVBQVNQLEVBQWFaLHVCQUF1QixNQUNuRGlCLEVBQWUxQix3QkFBd0I0QixHQUN2Q0YsRUFBZW5CLGlCQUNmbUIsRUFBZUcsaUJBQ2ZSLEVBQWVILEVBQWNDLEVBQVFDLEdBQ3JDTSxFQUFpQkosRUFBaUJDLEVBQVdDLE9DbEM1Q00sR0FDUkwsYSIsInNvdXJjZXMiOlsid2VicGFjazovL2pzLXRvcC1iYXR0bGVzaGlwLy4vc3JjL2xvZ2ljL3BsYXllci5qcyIsIndlYnBhY2s6Ly9qcy10b3AtYmF0dGxlc2hpcC8uL3NyYy9sb2dpYy9nYW1lYm9hcmQuanMiLCJ3ZWJwYWNrOi8vanMtdG9wLWJhdHRsZXNoaXAvLi9zcmMvbG9naWMvc2hpcC5qcyIsIndlYnBhY2s6Ly9qcy10b3AtYmF0dGxlc2hpcC8uL2dhbWUuanMiLCJ3ZWJwYWNrOi8vanMtdG9wLWJhdHRsZXNoaXAvLi9zcmMvaW5kZXguanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgR2FtZWJvYXJkIH0gZnJvbSAnLi9nYW1lYm9hcmQnXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gUGxheWVyKG5hbWUpe1xyXG4gICAgY29uc3QgX3BsYXllck5hbWUgPSBuYW1lXHJcblxyXG4gICAgY29uc3QgZ2V0TmFtZSA9ICgpID0+e1xyXG4gICAgICAgIHJldHVybiBfcGxheWVyTmFtZVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGNyZWF0ZUdhbWVCb2FyZCA9ICguLi5jb29yZGluYXRlcykgPT57XHJcbiAgICAgICAgY29uc3QgZ2FtZWJvYXJkID0gR2FtZWJvYXJkKClcclxuICAgICAgICBnYW1lYm9hcmQucG9wdWxhdGVHYW1lYm9hcmQoY29vcmRpbmF0ZXMpXHJcbiAgICAgICAgcmV0dXJuIGdhbWVib2FyZFxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHNlbmRBdHRhY2tDb29yZHNUb0dhbWUgPSAoY29vcmRzID0gJ0ExJykgPT57XHJcbiAgICAgICAgLy8gUmVjZWl2ZXMgY29vcmRzIGZyb20gYW4gZXZlbnQgbGlzdGVuZXJcclxuICAgICAgICAvLyBhbmQgc2VuZCBpdCB0byBnYW1lIFxyXG4gICAgICAgIHJldHVybiBjb29yZHNcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzZW5kUmFuZG9tQXR0YWNrQ29vcmRzVG9HYW1lID0gKGdhbWVib2FyZCkgPT57XHJcbiAgICAgICAgLy8gU2VsZWN0IGEgcmFuZG9tIHNxdWFyZSBmcm9tIF9ib2FyZEdyaWRcclxuICAgICAgICAvLyBhbmQgc2VuZCBpdCB0byB0aGUgZW5lbXkgZ2FtZWJvYXJkLnJlY2VpdmVBdHRhY2tGcm9tUGxheWVyXHJcbiAgICAgICAgY29uc3QgQk9BUkRfR1JJRF9MRU5HVEggID0gXHJcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKGdhbWVib2FyZC5nZXRCb2FyZEdyaWQoKSkubGVuZ3RoXHJcbiAgICAgICAgY29uc3QgaW5kZXggPSBnZW5lcmF0ZVJhbmRvbU51bWJlcigwLEJPQVJEX0dSSURfTEVOR1RIKVxyXG4gICAgICAgIHJldHVybiBPYmplY3Qua2V5cyhnYW1lYm9hcmQuZ2V0Qm9hcmRHcmlkKCkpW2luZGV4XVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGdlbmVyYXRlUmFuZG9tTnVtYmVyID0gKG1heCxtaW4pID0+e1xyXG4gICAgICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAobWF4IC0gbWluKSkgKyBtaW5cclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBpc1R1cm5PdmVyID0gKCkgPT57XHJcblxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGlzUGxheWVyRGVmZWF0ZWQgPSAoKSA9PntcclxuXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJue1xyXG4gICAgICAgIGdldE5hbWUsXHJcbiAgICAgICAgY3JlYXRlR2FtZUJvYXJkLFxyXG4gICAgICAgIHNlbmRBdHRhY2tDb29yZHNUb0dhbWUsXHJcbiAgICAgICAgc2VuZFJhbmRvbUF0dGFja0Nvb3Jkc1RvR2FtZVxyXG4gICAgfVxyXG59XHJcblxyXG4vLyBjb25zdCBwMSA9IFBsYXllcigpXHJcbi8vIGNvbnN0IGdiID0gcDEuY3JlYXRlR2FtZUJvYXJkKFsnQTEnLCdBMiddKVxyXG4vLyBjb25zb2xlLmxvZyhwMS5zZW5kUmFuZG9tQXR0YWNrQ29vcmRzVG9HYW1lYm9hcmQoZ2IpKSIsImltcG9ydCB7IFNoaXAgfSBmcm9tICcuL3NoaXAnXHJcblxyXG5leHBvcnQgZnVuY3Rpb24gR2FtZWJvYXJkKCl7XHJcbiAgIFxyXG4gICAgbGV0IF9ib2FyZEdyaWQgPSBcclxuICAgIHtcclxuICAgICAgICAnQTEnOiBmYWxzZSwgJ0EyJzogZmFsc2UsICdBMyc6IGZhbHNlLCAnQTQnOiBmYWxzZSwgJ0E1JzogZmFsc2UsICdBNic6IGZhbHNlLCAnQTcnOiBmYWxzZSwgJ0E4JzogZmFsc2UsIFxyXG4gICAgICAgICdCMSc6IGZhbHNlLCAnQjInOiBmYWxzZSwgJ0IzJzogZmFsc2UsICdCNCc6IGZhbHNlLCAnQjUnOiBmYWxzZSwgJ0I2JzogZmFsc2UsICdCNyc6IGZhbHNlLCAnQjgnOiBmYWxzZSwgXHJcbiAgICAgICAgJ0MxJzogZmFsc2UsICdDMic6IGZhbHNlLCAnQzMnOiBmYWxzZSwgJ0M0JzogZmFsc2UsICdDNSc6IGZhbHNlLCAnQzYnOiBmYWxzZSwgJ0M3JzogZmFsc2UsICdDOCc6IGZhbHNlLCBcclxuICAgICAgICAnRDEnOiBmYWxzZSwgJ0QyJzogZmFsc2UsICdEMyc6IGZhbHNlLCAnRDQnOiBmYWxzZSwgJ0Q1JzogZmFsc2UsICdENic6IGZhbHNlLCAnRDcnOiBmYWxzZSwgJ0Q4JzogZmFsc2UsIFxyXG4gICAgICAgICdFMSc6IGZhbHNlLCAnRTInOiBmYWxzZSwgJ0UzJzogZmFsc2UsICdFNCc6IGZhbHNlLCAnRTUnOiBmYWxzZSwgJ0U2JzogZmFsc2UsICdFNyc6IGZhbHNlLCAnRTgnOiBmYWxzZSwgXHJcbiAgICAgICAgJ0YxJzogZmFsc2UsICdGMic6IGZhbHNlLCAnRjMnOiBmYWxzZSwgJ0Y0JzogZmFsc2UsICdGNSc6IGZhbHNlLCAnRjYnOiBmYWxzZSwgJ0Y3JzogZmFsc2UsICdGOCc6IGZhbHNlLCBcclxuICAgICAgICAnRzEnOiBmYWxzZSwgJ0cyJzogZmFsc2UsICdHMyc6IGZhbHNlLCAnRzQnOiBmYWxzZSwgJ0c1JzogZmFsc2UsICdHNic6IGZhbHNlLCAnRzcnOiBmYWxzZSwgJ0c4JzogZmFsc2UsIFxyXG4gICAgICAgICdIMSc6IGZhbHNlLCAnSDInOiBmYWxzZSwgJ0gzJzogZmFsc2UsICdINCc6IGZhbHNlLCAnSDUnOiBmYWxzZSwgJ0g2JzogZmFsc2UsICdINyc6IGZhbHNlLCAnSDgnOiBmYWxzZSBcclxuICAgIH1cclxuXHJcbiAgICBsZXQgX2JvYXJkU2hpcHMgPSBbXVxyXG4gICAgXHJcbiAgICBjb25zdCBnZXRCb2FyZEdyaWQgPSAoKSA9PntcclxuICAgICAgICByZXR1cm4gX2JvYXJkR3JpZFxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IGdldEJvYXJkU2hpcHMgPSAoKSA9PntcclxuICAgICAgICByZXR1cm4gX2JvYXJkU2hpcHNcclxuICAgIH1cclxuICAgIFxyXG4gICAgY29uc3QgcG9wdWxhdGVHYW1lYm9hcmQgPSAoY29vcmRpbmF0ZXMpID0+e1xyXG4gICAgICAgIGxldCBpbmRleCA9IDBcclxuICAgICAgICB3aGlsZSggaW5kZXggPCBjb29yZGluYXRlcy5sZW5ndGggKXtcclxuICAgICAgICAgICAgY3JlYXRlU2hpcCguLi5jb29yZGluYXRlc1tpbmRleF0pXHJcbiAgICAgICAgICAgIGluZGV4KytcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgLy8gSW5jb21pbmctcXVlcnkgKGFzc2VydCByZXN1bHQpIFhcclxuICAgIGNvbnN0IGNyZWF0ZVNoaXAgPSAoLi4uY29vcmRpbmF0ZXMpID0+e1xyXG4gICAgICAgIGNvbnN0IHNoaXAgID0gU2hpcCguLi5jb29yZGluYXRlcykgXHJcbiAgICAgICAgX2JvYXJkU2hpcHMgPSBhZGRTaGlwVG9TaGlwc0FycmF5KHNoaXApXHJcbiAgICAgICAgYWRkU2hpcFRvQm9hcmRHcmlkT2JqZWN0KHNoaXApXHJcbiAgICAgICAgcmV0dXJuIHNoaXBcclxuICAgIH1cclxuICAgIFxyXG4gICAgLy8gSW5jb21pbmctcXVlcnkgKGFzc2VydCByZXN1bHQpXHJcbiAgICBjb25zdCByZWNlaXZlQXR0YWNrRnJvbVBsYXllciA9IChzZW5kQ29vcmRzRE9NID0gJ0ExJyk9PntcclxuICAgICAgICBjb25zdCBjb29yZHMgPSBzZW5kQ29vcmRzRE9NIC8vIFdpbGwgYmUgYSBtZXRob2QgbGF0ZXJcclxuICAgICAgICBcclxuICAgICAgICBpZihpc1NoaXBIaXQoY29vcmRzKSl7XHJcbiAgICAgICAgICAgIGNvbnN0IHNoaXAgPSBmaW5kU2hpcEJ5Q29vcmRzKGNvb3JkcylcclxuICAgICAgICAgICAgc2hpcC5pc1N1bmtOZXh0SGl0KCkgXHJcbiAgICAgICAgICAgICAgICA/IF9ib2FyZFNoaXBzID0gcmVtb3ZlU2hpcEZyb21TaGlwc0FycmF5KHNoaXApIFxyXG4gICAgICAgICAgICAgICAgOiBfYm9hcmRHcmlkICA9IHJlbW92ZVNoaXBTcXVhcmUoY29vcmRzLHNoaXApXHJcbiAgICAgICAgICAgIHJldHVyblxyXG4gICAgICAgIH1cclxuICAgICAgICAvLyBTZW5kIHJlbmRlciBpbmZvIHRvIHRoZSBET00gb3IgdXNlIGFub3RoZXIgZnVuY3Rpb24/XHJcbiAgICAgICAgcmV0dXJuIGNvb3Jkc1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHJlbW92ZVNoaXBTcXVhcmUgPSAoY29vcmRzLHNoaXApID0+e1xyXG4gICAgICAgIHNoaXAucmVtb3ZlU3F1YXJlSGl0KGNvb3JkcylcclxuICAgICAgICByZXR1cm4gcmVtb3ZlU3F1YXJlRnJvbUJvYXJkR3JpZE9iamVjdChjb29yZHMpXHJcbiAgICB9XHJcbiBcclxuICAgIC8vIFF1ZXJ5ICYgQ29tbWFuZCBzZWxmIHhcclxuICAgIGNvbnN0IGFkZFNoaXBUb0JvYXJkR3JpZE9iamVjdCA9IChzaGlwKSA9PntcclxuICAgICAgICBjb25zdCBjb29yZHNBcnJheSA9IHNoaXAuZ2V0U2hpcENvb3JkKClcclxuICAgICAgICBsZXQgaW5kZXhBcnJheSAgICA9IDBcclxuICAgICAgICBmb3IoY29uc3QgW2tleV0gb2YgT2JqZWN0LmVudHJpZXMoX2JvYXJkR3JpZCkpe1xyXG4gICAgICAgICAgICBpZihrZXkgPT09IGNvb3Jkc0FycmF5W2luZGV4QXJyYXldKXtcclxuICAgICAgICAgICAgICAgIF9ib2FyZEdyaWRba2V5XSA9IHRydWVcclxuICAgICAgICAgICAgICAgIGluZGV4QXJyYXkrK1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSAgICAgICBcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBhZGRTaGlwVG9TaGlwc0FycmF5ID0gKHNoaXApID0+e1xyXG4gICAgICAgIHJldHVybiBbLi4uX2JvYXJkU2hpcHMsc2hpcF1cclxuICAgIH1cclxuXHJcbiAgICBjb25zdCByZW1vdmVTcXVhcmVGcm9tQm9hcmRHcmlkT2JqZWN0ID0gKGNvb3JkcykgPT57XHJcbiAgICAgICAgcmV0dXJuIE9iamVjdC5hc3NpZ24oey4uLl9ib2FyZEdyaWR9LCB7W2Ake2Nvb3Jkc31gXTogJ0hpdCd9KVxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHJlbW92ZVNoaXBGcm9tU2hpcHNBcnJheSA9IChzaGlwKSA9PntcclxuICAgICAgICBjb25zdCBzaGlwSW5kZXggPSBmaW5kU2hpcEluZGV4QnlOYW1lKHNoaXApXHJcbiAgICAgICAgcmV0dXJuIF9ib2FyZFNoaXBzLmZpbHRlcihhcnJheVNoaXAgPT57XHJcbiAgICAgICAgICAgIHJldHVybiBfYm9hcmRTaGlwcy5pbmRleE9mKGFycmF5U2hpcCkgIT09IHNoaXBJbmRleCBcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG4gXHJcbiAgICBjb25zdCBmaW5kU2hpcEJ5Q29vcmRzID0gKGNvb3JkcykgPT57XHJcbiAgICAgICAgLy8gZm9yIG5vdyB3ZSBwYXNzIGFuIGFycmF5IHdpdGggYWxyZWFkeSBpbnNlcnRlZCB2YWx1ZXNcclxuICAgICAgICByZXR1cm4gX2JvYXJkU2hpcHMuZmluZChzaGlwID0+e1xyXG4gICAgICAgICAgICByZXR1cm4gc2hpcC5nZXRTaGlwQ29vcmQoKS5pbmNsdWRlcyhjb29yZHMpICAgIFxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgZmluZFNoaXBJbmRleEJ5TmFtZSA9IChzaGlwKSA9PntcclxuICAgICAgICByZXR1cm4gX2JvYXJkU2hpcHMuZmluZEluZGV4KGN1cnJlbnRTaGlwID0+e1xyXG4gICAgICAgICAgICByZXR1cm4gY3VycmVudFNoaXAuZ2V0U2hpcE5hbWUoKSA9PT0gc2hpcC5nZXRTaGlwTmFtZSgpXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyAvLyBPdXRnb2luZy1xdWVyeSB4XHJcbiAgICAvLyBjb25zdCBzZW5kU2hpcENvb3JkID0gKCkgPT57IFxyXG4gICAgLy8gICAgIC8vIEdldHMgYSBTaGlwIG9iamVjdCBhbmQgc2VuZHNcclxuICAgIC8vICAgICAvLyBpdCdzIGNvb3JkaW5hdGVzIHRvIFZpZXdcclxuICAgIC8vIH1cclxuICAgIFxyXG4gICAgLy8gLy8gT3V0Z29pbmcgcXVlcnkgeFxyXG4gICAgLy8gY29uc3Qgc2VuZEhpdENvb3JkID0gKCkgPT57XHJcbiAgICAvLyAgICAgLy8gU2VuZCBoaXQgY29vcmRpbmF0ZXMgdG8gdGhlIGhpdFxyXG4gICAgLy8gICAgIC8vIHNoaXBcclxuICAgIC8vIH1cclxuXHJcbiAgICBjb25zdCBpc1NoaXBIaXQgPSAoY29vcmRzKSA9PntcclxuICAgICAgICBmb3IoY29uc3QgW2tleV0gb2YgT2JqZWN0LmVudHJpZXMoX2JvYXJkR3JpZCkpe1xyXG4gICAgICAgICAgICBpZihrZXkgPT09IGNvb3JkcyAmJiBfYm9hcmRHcmlkW2tleV0pe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWVcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBpc0FsbFNoaXBzU3VuayA9ICgpID0+e1xyXG4gICAgICAgIHJldHVybiBfYm9hcmRTaGlwcy5sZW5ndGggPT09IDAgPyB0cnVlIDogZmFsc2VcclxuICAgIH1cclxuICBcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgZ2V0Qm9hcmRHcmlkLFxyXG4gICAgICAgIGdldEJvYXJkU2hpcHMsXHJcbiAgICAgICAgY3JlYXRlU2hpcCxcclxuICAgICAgICBwb3B1bGF0ZUdhbWVib2FyZCxcclxuICAgICAgICByZWNlaXZlQXR0YWNrRnJvbVBsYXllcixcclxuICAgICAgICByZW1vdmVTaGlwRnJvbVNoaXBzQXJyYXksXHJcbiAgICAgICAgaXNBbGxTaGlwc1N1bmssXHJcbiAgICB9XHJcbn1cclxuXHJcbiIsImV4cG9ydCBmdW5jdGlvbiBTaGlwKC4uLmNvb3JkaW5hdGVzKXtcclxuXHJcbiAgICBsZXQgX3NoaXBDb29yZCA9IGNvb3JkaW5hdGVzXHJcblxyXG4gICAgY29uc3QgX1NISVBfTkFNRVMgPSB7XHJcbiAgICAgICAgMSA6ICdTcHknLFxyXG4gICAgICAgIDIgOiAnRGVzdHJveWVyJyxcclxuICAgICAgICAzIDogJ0NydWlzZXInLFxyXG4gICAgICAgIDQgOiAnQmF0dGxlc2hpcCcsXHJcbiAgICAgICAgNSA6ICdDYXJyaWVyJ1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IF9zaGlwTmFtZSA9IF9TSElQX05BTUVTW19zaGlwQ29vcmQubGVuZ3RoXVxyXG4gICAgXHJcbiAgICBjb25zdCBnZXRTaGlwTmFtZSA9ICgpID0+e1xyXG4gICAgICAgIHJldHVybiBfc2hpcE5hbWVcclxuICAgIH1cclxuXHJcbiAgICAvLyBPdXRnb2luZyBxdWVyeSB4XHJcbiAgICBjb25zdCBnZXRTaGlwQ29vcmQgPSAoKSA9PntcclxuICAgICAgICByZXR1cm4gX3NoaXBDb29yZFxyXG4gICAgfVxyXG5cclxuICAgIC8vIEluY29taW5nIHF1ZXJ5IChhc3NlcnQgcmVzdWx0KVxyXG4gICAgY29uc3QgZmluZEhpdEluZGV4ID0gKGNvb3JkcykgPT57XHJcbiAgICAgICAgcmV0dXJuIF9zaGlwQ29vcmQuaW5kZXhPZihjb29yZHMpICAgIFxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBTZWxmIGNvbW1hbmQgeFxyXG4gICAgY29uc3QgcmVtb3ZlU3F1YXJlSGl0ID0gKGNvb3JkcykgPT57XHJcbiAgICAgICAgLy8gVXNlIGZpbHRlciBhbmQgcmV0dXJuIGEgbmV3IGFycmF5P1xyXG4gICAgICAgIGNvbnN0IGluZGV4Q29vcmQgPSBmaW5kSGl0SW5kZXgoY29vcmRzKVxyXG4gICAgICAgIF9zaGlwQ29vcmQgPSBfc2hpcENvb3JkLmZpbHRlcihjb29yZCA9PntcclxuICAgICAgICAgICAgcmV0dXJuIF9zaGlwQ29vcmQuaW5kZXhPZihjb29yZCkgIT09IGluZGV4Q29vcmQgXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyBQdXJlIC8gT3V0Z29pbmcgcXVlcnkgeFxyXG4gICAgY29uc3QgaXNTdW5rTmV4dEhpdCA9ICgpID0+e1xyXG4gICAgICAgIHJldHVybiBfc2hpcENvb3JkLmxlbmd0aCA9PT0gMSA/IHRydWUgOiBmYWxzZVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIGdldFNoaXBOYW1lLFxyXG4gICAgICAgIGdldFNoaXBDb29yZCxcclxuICAgICAgICBpc1N1bmtOZXh0SGl0LFxyXG4gICAgICAgIHJlbW92ZVNxdWFyZUhpdFxyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCB7IFBsYXllciB9IGZyb20gJy4vc3JjL2xvZ2ljL3BsYXllcidcclxuZXhwb3J0IGZ1bmN0aW9uIEdhbWUgKCl7XHJcblxyXG4gICAgY29uc3Qgc2V0dXBHYW1lID0gKCkgPT57XHJcbiAgICAgICAgbGV0IHBsYXllckluVHVybiA9IHBsYXllcjFcclxuICAgICAgICBsZXQgZW5lbXlHYW1lYm9hcmQgPSBnYW1lYm9hcmQyXHJcbiAgICBcclxuICAgICAgICBjb25zdCBwbGF5ZXIxID0gUGxheWVyKCdWaWN0b3InKVxyXG4gICAgICAgIGNvbnN0IHBsYXllcjIgPSBQbGF5ZXIoJ09sZ2EnKVxyXG5cclxuICAgICAgICBjb25zdCBnYW1lYm9hcmQxID0gcGxheWVyMS5jcmVhdGVHYW1lQm9hcmQoXHJcbiAgICAgICAgICAgIFsnQTEnXSxcclxuICAgICAgICAgICAgWydCMScsJ0IyJ10sXHJcbiAgICAgICAgICAgIFsnQzEnLCdDMicsJ0MzJ10sXHJcbiAgICAgICAgICAgIFsnRDEnLCdEMicsJ0QzJywnRDQnXSxcclxuICAgICAgICAgICAgWydFMScsJ0UyJywnRTMnLCdFNCcsJ0U1J11cclxuICAgICAgICApXHJcblxyXG4gICAgICAgIGNvbnN0IGdhbWVib2FyZDIgPSBwbGF5ZXIyLmNyZWF0ZUdhbWVCb2FyZCggICAgICAgICAgICBcclxuICAgICAgICAgICAgWydBMSddLFxyXG4gICAgICAgICAgICBbJ0IxJywnQjInXSxcclxuICAgICAgICAgICAgWydDMScsJ0MyJywnQzMnXSxcclxuICAgICAgICAgICAgWydEMScsJ0QyJywnRDMnLCdENCddLFxyXG4gICAgICAgICAgICBbJ0UxJywnRTInLCdFMycsJ0U0JywnRTUnXVxyXG4gICAgICAgIClcclxuXHJcbiAgICAgICAgd2hpbGUoXHJcbiAgICAgICAgICAgICFwbGF5ZXIxLmlzUGxheWVyRGVmZWF0ZWQoKVxyXG4gICAgICAgICAgICB8fFxyXG4gICAgICAgICAgICAhcGxheWVyMi5pc1BsYXllckRlZmVhdGVkKClcclxuICAgICAgICApe1xyXG4gICAgICAgICAgICBjb25zdCBhdHRhY2sgPSBwbGF5ZXJJblR1cm4uc2VuZEF0dGFja0Nvb3Jkc1RvR2FtZSgnQTEnKVxyXG4gICAgICAgICAgICBlbmVteUdhbWVib2FyZC5yZWNlaXZlQXR0YWNrRnJvbVBsYXllcihhdHRhY2spXHJcbiAgICAgICAgICAgIGVuZW15R2FtZWJvYXJkLmlzQWxsU2hpcHNTdW5rKClcclxuICAgICAgICAgICAgZW5lbXlHYW1lYm9hcmQuc2VuZFN0YXRlVG9ET00oKVxyXG4gICAgICAgICAgICBwbGF5ZXJJblR1cm4gPSBzd2l0Y2hQbGF5ZXJzKHBsYXllcjEscGxheWVyMilcclxuICAgICAgICAgICAgZW5lbXlHYW1lYm9hcmQgPSBzd2l0Y2hHYW1lYm9hcmRzKGdhbWVib2FyZDEsZ2FtZWJvYXJkMilcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3Qgc3dpdGNoUGxheWVycyA9IChwbGF5ZXIxLHBsYXllcjIpID0+e1xyXG4gICAgICAgIHJldHVybiBwbGF5ZXJJblR1cm4gPT09IHBsYXllcjIgPyBwbGF5ZXIxIDogcGxheWVyMlxyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHN3aXRjaEdhbWVib2FyZHMgPSAocGxheWVyMixnYW1lYm9hcmQxLGdhbWVib2FyZDIpID0+e1xyXG4gICAgICAgIHJldHVybiBwbGF5ZXJJblR1cm4gPT09IHBsYXllcjIgPyBnYW1lYm9hcmQxIDogZ2FtZWJvYXJkMlxyXG4gICAgfSAgIFxyXG5cclxuICAgIHJldHVybntzZXR1cEdhbWV9XHJcbn0iLCJpbXBvcnQgeyBHYW1lIH0gZnJvbSAnLi4vZ2FtZSdcclxuXHJcbmNvbnN0IGdhbWUgPSBHYW1lKClcclxuZ2FtZS5zZXR1cEdhbWUoKSJdLCJuYW1lcyI6WyJQbGF5ZXIiLCJuYW1lIiwiX3BsYXllck5hbWUiLCJnZXROYW1lIiwiY3JlYXRlR2FtZUJvYXJkIiwiY29vcmRpbmF0ZXMiLCJnYW1lYm9hcmQiLCJfYm9hcmRHcmlkIiwiX2JvYXJkU2hpcHMiLCJjcmVhdGVTaGlwIiwic2hpcCIsIl9zaGlwQ29vcmQiLCJfc2hpcE5hbWUiLCJsZW5ndGgiLCJnZXRTaGlwTmFtZSIsImdldFNoaXBDb29yZCIsImlzU3Vua05leHRIaXQiLCJyZW1vdmVTcXVhcmVIaXQiLCJjb29yZHMiLCJpbmRleENvb3JkIiwiaW5kZXhPZiIsImZpbmRIaXRJbmRleCIsImZpbHRlciIsImNvb3JkIiwiU2hpcCIsImFkZFNoaXBUb1NoaXBzQXJyYXkiLCJhZGRTaGlwVG9Cb2FyZEdyaWRPYmplY3QiLCJjb29yZHNBcnJheSIsImluZGV4QXJyYXkiLCJrZXkiLCJPYmplY3QiLCJlbnRyaWVzIiwicmVtb3ZlU3F1YXJlRnJvbUJvYXJkR3JpZE9iamVjdCIsImFzc2lnbiIsInJlbW92ZVNoaXBGcm9tU2hpcHNBcnJheSIsInNoaXBJbmRleCIsImZpbmRTaGlwSW5kZXhCeU5hbWUiLCJhcnJheVNoaXAiLCJmaW5kSW5kZXgiLCJjdXJyZW50U2hpcCIsImdldEJvYXJkR3JpZCIsImdldEJvYXJkU2hpcHMiLCJwb3B1bGF0ZUdhbWVib2FyZCIsImluZGV4IiwicmVjZWl2ZUF0dGFja0Zyb21QbGF5ZXIiLCJzZW5kQ29vcmRzRE9NIiwiaXNTaGlwSGl0IiwiZmluZCIsImluY2x1ZGVzIiwiZmluZFNoaXBCeUNvb3JkcyIsInJlbW92ZVNoaXBTcXVhcmUiLCJpc0FsbFNoaXBzU3VuayIsIkdhbWVib2FyZCIsInNlbmRBdHRhY2tDb29yZHNUb0dhbWUiLCJzZW5kUmFuZG9tQXR0YWNrQ29vcmRzVG9HYW1lIiwiQk9BUkRfR1JJRF9MRU5HVEgiLCJrZXlzIiwibWF4IiwibWluIiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwic3dpdGNoUGxheWVycyIsInBsYXllcjEiLCJwbGF5ZXIyIiwicGxheWVySW5UdXJuIiwic3dpdGNoR2FtZWJvYXJkcyIsImdhbWVib2FyZDEiLCJnYW1lYm9hcmQyIiwic2V0dXBHYW1lIiwiZW5lbXlHYW1lYm9hcmQiLCJpc1BsYXllckRlZmVhdGVkIiwiYXR0YWNrIiwic2VuZFN0YXRlVG9ET00iLCJHYW1lIl0sInNvdXJjZVJvb3QiOiIifQ==